@{
    Layout = "~/Shared/_Layout.cshtml";
    Page.Title = "Evenementen";

    string action = "";

    if (IsPost)
    {
        action = Request["action"];

        if (action.Equals("login") && Session["cursist"] == null)
        {
            Session["cursist"] = Administratix.Model.Cursist.GetCursistByCursistNummer(Convert.ToInt32(Request["Login-CursistNummer"]));
        }
        if (action.Equals("logout"))
        {
            Session["cursist"] = null;
        }
    }

    //Dit is om nederlandse weekdagen te krijgen
    System.Globalization.CultureInfo culture = new System.Globalization.CultureInfo("nl-BE");

    string message = "Alles gaat goed";
    List<Administratix.BLL.Evenement> evenementenLijst = new List<Administratix.BLL.Evenement>();

    evenementenLijst = Administratix.Model.Evenement.EvenementSelectAll();
    Administratix.BLL.Cursist cursist = (Administratix.BLL.Cursist)Session["cursist"];
        
        if (action.Equals("inschrijven"))
        {
            message = Administratix.Model.EvenementInschrijving.InsertEvenementInschrijving(cursist.CursistNummer, Request["inschrijven"], Request["opmerkingen-inschrijving"]);
        }
    }   
    
}

<main>
    <div id="centerContainer">
        <form id="evenementen-display" action="" method="post">
            <fieldset>
                <legend>Display opties</legend>
                <button type="submit" name="action" value="ingeschreven-evenementen tonen">Mijn ingeschreven evenementen</button>
                <button type="submit" name="action" value="alle-evenementen">Alle evenementen</button>
            </fieldset>
        </form>
    </div>

    @*  DIT WERKT NOG NIET  *@
    @*<form id="viewallevenement" action="" method="post"> 
        @{
            if(evenementenLijst.Count <= 0)
            {
                <p>Geen evenementen gevonden.</p>
            }
            else
            {
                <table>
                    <tr>
                        <th>Naam</th>
                        <th>Weekdag</th>
                        <th>Datum</th>
                        <th>Locatie</th>
                        <th>Start</th>
                        <th>Einde</th>
                        <th></th>
                        <th>Opmerkingen</th>
                    </tr>
                    @{
                    foreach(Administratix.BLL.Evenement item in evenementenLijst)
                    {
                        <tr>
                            <td>@item.Naam</td>
                            <td>@item.Datum</td>
                            <td>@item.Datum</td>
                            <td>@item.Locatie</td>
                            <td>@item.Start</td>
                            <td>@item.Eind</td>
                            <td><button type="submit" name="inschrijven" value="@item.Id">Schrijf me in!</button></td>
                            <td><input type="text" name="opmerkingen-inschrijving" id="opmerkingen-inschrijving"/></td>
                        </tr>
                    }
                    }
                </table>
                      
            }
        }
    </form>*@

    <div class="containerBig">
        <div class="containerCalendarRow">
            <div class="containerCalendarTitle columnBig">
                Naam
            </div>
            <div class="containerCalendarTitle">
                Datum
            </div>
            <div class="containerCalendarTitle">
                Locatie
            </div>
            <div class="containerCalendarTitle">
                Start
            </div>
            <div class="containerCalendarTitle">
                Einde
            </div>
            <div class="containerCalendarTitle">

            </div>
            @if(Session["cursist"]!=null){
            <div class="containerCalendarTitle">
                Opmerkingen
            </div>
            }
        </div>
        <form id="evenement-inschrijven" method="post" action=""></form>
              @for (int i = 0; i < evenementenLijst.Count; i++)
              {
                
                    Administratix.BLL.Evenement evenement = evenementenLijst[i];
                    <div class="containerCalendarRow @(i%2 == 0 ? "":"shaded")">
                        <form id="evenement-inschrijving" method="post" action="">
                            <div class="containerCalendarTitle">
                                @evenement.Naam <input type="hidden" name="evenement-id" id="evenement-id" value="@evenement.Id" />
                            </div>
                            <div class="containerCalendarTitle">
                                @evenement.Datum
                            </div>
                            <div class="containerCalendarTitle">
                                @evenement.Locatie
                            </div>
                            <div class="containerCalendarTitle">
                                @evenement.Start
                            </div>
                            <div class="containerCalendarTitle">
                                @evenement.Eind
                            </div>
                            @if (Session["cursist"] != null)
                            {
                                <div class="containerCalendarTitle">
                                    <input type="text" name="opmerkingen-inschrijving" id="opmerkingen-inschrijving" />
                                </div>
                                <div class="containerCalendarTitle">
                                    <button type="submit" name="inschrijven" value="@evenement.Id">Schrijf me in!</button>
                                </div>
                            }
                        </form>
                    </div>
                

              }
        

    </div>

    

</main>
@message